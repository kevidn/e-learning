{% load static %}

{# GRID CONTENT #}
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in-up">
    {% for course in courses %}
    <div class="group relative flex flex-col bg-[#1A1D24] rounded-[2rem] border border-white/5 overflow-hidden hover:border-indigo-500/30 hover:shadow-[0_0_40px_rgba(99,102,241,0.15)] hover:-translate-y-1 transition-all duration-300 h-full">
        
        {# Card Image #}
        <div class="relative h-52 bg-[#20242C] overflow-hidden">
            <img src="https://images.unsplash.com/photo-1516321318423-f06f85e504b3?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60" 
                 alt="{{ course.course_name }}" 
                 class="w-full h-full object-cover opacity-60 group-hover:opacity-100 group-hover:scale-105 transition-all duration-700 grayscale group-hover:grayscale-0">
            
            <div class="absolute inset-0 bg-gradient-to-t from-[#1A1D24] via-[#1A1D24]/20 to-transparent"></div>
            
            {# Badge Status #}
            <div class="absolute top-4 right-4 z-10">
                {% if course.course_id in enrolled_ids %}
                    <div class="flex items-center gap-1.5 px-3 py-1.5 bg-green-500/20 backdrop-blur-md border border-green-500/30 rounded-full text-[10px] font-bold text-green-400 uppercase tracking-widest shadow-lg">
                        <i data-feather="check-circle" class="w-3 h-3"></i> Terdaftar
                    </div>
                {% else %}
                    <div class="flex items-center gap-1.5 px-3 py-1.5 bg-black/40 backdrop-blur-md border border-white/10 rounded-full text-[10px] font-bold text-white uppercase tracking-widest shadow-lg group-hover:bg-indigo-600 group-hover:border-indigo-500 transition-colors">
                        <i data-feather="unlock" class="w-3 h-3"></i> Tersedia
                    </div>
                {% endif %}
            </div>

            <div class="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-[#1A1D24] to-transparent">
                <h3 class="text-xl font-bold text-white leading-tight line-clamp-2 group-hover:text-indigo-300 transition-colors">
                    {{ course.course_name }}
                </h3>
            </div>
        </div>

        {# Card Body #}
        <div class="p-6 pt-2 flex-1 flex flex-col">
            <div class="flex items-center gap-3 mb-4 pb-4 border-b border-white/5">
                <div class="w-10 h-10 rounded-full bg-[#252A33] border-2 border-[#1A1D24] flex items-center justify-center text-sm font-bold text-gray-400 shadow-sm group-hover:border-indigo-500/30 transition-colors">
                    {{ course.lecturer.name|slice:":1" }}
                </div>
                <div>
                    <p class="text-[10px] text-gray-500 uppercase font-bold tracking-wider mb-0.5">Dosen Pengampu</p>
                    <p class="text-sm font-bold text-gray-200 truncate max-w-[150px]">{{ course.lecturer.name }}</p>
                </div>
            </div>

            <p class="text-sm text-gray-400 mb-6 line-clamp-3 flex-1 leading-relaxed">
                {{ course.description|default:"Tidak ada deskripsi singkat untuk kelas ini." }}
            </p>

            <div class="mt-auto">
                {% if course.course_id in enrolled_ids %}
                    <a href="{% url 'course_detail' course.course_id %}" class="w-full flex items-center justify-center gap-2 py-3.5 rounded-xl bg-[#252A33] text-white font-bold border border-white/5 hover:bg-indigo-600 hover:border-indigo-600 hover:shadow-lg hover:shadow-indigo-600/20 transition-all group/btn">
                        Lanjutkan <i data-feather="arrow-right" class="w-4 h-4 transition-transform group-hover/btn:translate-x-1"></i>
                    </a>
                {% else %}
                    <div class="flex gap-3">
                        
                        {# 1. Tombol Detail #}
                        <a href="{% url 'course_detail' course.course_id %}" class="flex-1 flex items-center justify-center py-3.5 rounded-xl bg-[#252A33] text-gray-300 font-bold text-xs hover:bg-[#2F343E] hover:text-white border border-white/5 transition-all">
                            Lihat Detail
                        </a>

                        {# 2. Tombol Daftar (Enroll) #}
                        <form action="{% url 'enroll_course' course.course_id %}" method="POST" class="flex-1">
                            {% csrf_token %}
                            <button type="submit" class="w-full h-full flex items-center justify-center gap-2 rounded-xl bg-white text-black font-bold text-xs hover:bg-gray-200 border border-transparent transition-all shadow-lg hover:shadow-white/10 transform active:scale-[0.98]">
                                <i data-feather="plus-circle" class="w-3.5 h-3.5"></i> Daftar
                            </button>
                        </form>
                        
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-span-full py-24 text-center">
        <div class="w-20 h-20 bg-[#1A1D24] rounded-full flex items-center justify-center mx-auto mb-4 text-gray-600 border border-white/5">
            <i data-feather="search" class="w-8 h-8"></i>
        </div>
        <h3 class="text-xl font-bold text-white mb-2">Tidak ditemukan</h3>
        <p class="text-gray-500">Coba kata kunci lain atau ubah filter pencarian Anda.</p>
        <button onclick="resetFilters()" class="mt-6 px-6 py-2.5 rounded-xl bg-[#252A33] text-white font-bold text-sm hover:bg-indigo-600 transition-colors border border-white/5">
            Reset Filter
        </button>
    </div>
    {% endfor %}
</div>

{# PAGINATION (AJAX BASED) #}
{% if courses.has_other_pages %}
<div class="flex justify-center mt-12 animate-fade-in-up" style="animation-delay: 0.1s;">
    <div class="bg-[#1A1D24] p-1.5 rounded-2xl border border-white/10 flex items-center gap-1 shadow-xl">
        
        {# Prev #}
        {% if courses.has_previous %}
            <button onclick="goToPage({{ courses.previous_page_number }})" class="w-10 h-10 flex items-center justify-center rounded-xl text-gray-400 hover:text-white hover:bg-white/5 transition-all">
                <i data-feather="chevron-left" class="w-5 h-5"></i>
            </button>
        {% else %}
            <span class="w-10 h-10 flex items-center justify-center rounded-xl text-gray-700 cursor-not-allowed">
                <i data-feather="chevron-left" class="w-5 h-5"></i>
            </span>
        {% endif %}

        <div class="h-6 w-px bg-white/10 mx-1"></div>

        {# Page Numbers #}
        {% for i in courses.paginator.page_range %}
            {% if courses.number == i %}
                <span class="w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-600 text-white font-bold shadow-lg shadow-indigo-600/30 scale-105">{{ i }}</span>
            {% else %}
                <button onclick="goToPage({{ i }})" class="w-10 h-10 flex items-center justify-center rounded-xl text-gray-400 hover:text-white hover:bg-white/5 transition-all font-medium">{{ i }}</button>
            {% endif %}
        {% endfor %}

        <div class="h-6 w-px bg-white/10 mx-1"></div>

        {# Next #}
        {% if courses.has_next %}
            <button onclick="goToPage({{ courses.next_page_number }})" class="w-10 h-10 flex items-center justify-center rounded-xl text-gray-400 hover:text-white hover:bg-white/5 transition-all">
                <i data-feather="chevron-right" class="w-5 h-5"></i>
            </button>
        {% else %}
            <span class="w-10 h-10 flex items-center justify-center rounded-xl text-gray-700 cursor-not-allowed">
                <i data-feather="chevron-right" class="w-5 h-5"></i>
            </span>
        {% endif %}
    </div>
</div>
{% endif %}